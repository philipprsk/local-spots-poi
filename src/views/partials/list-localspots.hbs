{{#each localspots}}
  <div class="box">
    <div class="columns is-vcentered is-mobile">
      
      <!-- Links: Text -->
      <div class="column is-4">
        <p class="title is-5 mb-2">{{title}}</p>
        {{#if category}}
        <span class="tag is-info is-light mb-2">{{category.icon}} {{category.name}}</span>
        {{/if}}
        <p class="has-text-grey is-size-7">{{description}}</p>
      </div>
      
      <!-- Mitte: Bild -->
      <div class="column is-4 has-text-centered">
        {{#if img}}
        <figure class="image is-128x128 is-inline-block">
          <img src="{{img}}" alt="{{title}}" style="object-fit: cover; border-radius: 8px;">
        </figure>
        {{else}}
        <figure class="image is-128x128 is-inline-block" style="background: #f5f5f5; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
          <i class="fas fa-image fa-3x has-text-grey-light"></i>
        </figure>
        {{/if}}
      </div>
      
      <!-- Rechts: Actions -->
      <div class="column is-4 has-text-right">
        <div class="buttons are-small is-right">
          <a class="button is-light" title="Coming Soon">
            <span class="icon"><i class="fas fa-map-marker-alt"></i></span>
          </a>
          {{#if img}}
          <form action="/localspot/{{_id}}/deleteimage" method="POST" style="display: inline;">
            <button class="button is-small is-danger is-light" type="submit">
              <span class="icon"><i class="fas fa-times"></i></span>
            </button>
          </form>
          {{else}}
          <form action="/localspot/{{_id}}/uploadimage" method="POST" enctype="multipart/form-data" style="display: inline;">
            <input type="file" name="imagefile" accept="image/png, image/jpeg" id="upload-{{_id}}" style="display: none;">
            <label class="button is-small is-info is-light" for="upload-{{_id}}" style="cursor: pointer; margin-bottom: 0;">
              <span class="icon"><i class="fas fa-upload"></i></span>
            </label>
          </form>
          {{/if}}
          <a href="/dashboard/deletelocalspot/{{_id}}" class="button is-small is-danger is-light">
            <span class="icon"><i class="fas fa-trash"></i></span>
          </a>
        </div>
      </div>
      
    </div>
  </div>
{{/each}}

<script>
document.querySelectorAll('input[type="file"]').forEach(input => {
  input.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
      e.target.form.submit();
    }
  });
});
</script>